---
description: 如何与用户进行需求沟通，并将初步需求逐步细化为结构化PRD的交互模式
globs: tasks/*prd*.*
alwaysApply: false
---
## 激活条件
当用户提出类似以下表述时激活此规则：
- 描述新功能或产品想法
- 提及需要实现某个特性
- 询问如何构建或开发某项功能
- 使用"我需要..."、"我想要..."等表达需求的句式

## 引导原则

### 1. 主动切换到需求分析模式
- 当检测到用户正在描述一个新需求时，主动切换到"业务分析师"角色
- 明确告知用户："我注意到您正在描述一个新功能需求。为了更好地理解并帮助您实现它，我需要收集一些关键信息。"

### 2. 系统化的需求收集

使用以下结构性问题框架收集关键信息：

- **目标与价值**
  - 此功能解决什么问题？
  - 谁会使用此功能？（目标用户）
  - 实现此功能的业务价值是什么？

- **功能范围**
  - 核心功能点是什么？
  - 有哪些必要的子功能？
  - 对功能的性能或规模有特殊要求吗？
  
- **用户体验**
  - 用户如何与此功能交互？
  - 需要什么样的界面元素？
  - 有特定的用户流程要求吗？
  
- **技术约束**
  - 需要使用特定的技术栈、框架或库吗？
  - 是否需要与现有系统集成？如何集成？
  - 有安全、性能或兼容性要求吗？
  
- **验收标准**
  - 如何判断此功能实现成功？
  - 有哪些必须满足的条件？
  - 需要哪些测试来验证功能正常？

### 3. 交互式反馈与细化
- 针对用户回答进行跟进提问，深入挖掘细节
- 当发现信息不一致或模糊时，提出澄清性问题
- 主动提供可能的选项或建议，帮助用户明确需求
- 总结已获取的信息，确认理解是否准确

### 4. PRD生成与确认
- 当信息收集充分后，提示："根据我们的讨论，我可以生成一份结构化的PRD文档了。"
- 使用标准PRD模板组织收集的信息
- 以Markdown格式呈现PRD草稿
- 明确请求用户审核和确认

## PRD模板结构

```markdown
# {功能/产品名称} PRD

## 概述 (Overview)
[简明扼要地描述这个功能/产品是什么，解决什么问题，为谁提供价值]

## 核心功能 (Core Features)
[列出并详细描述主要功能点]
- 功能点1: [描述]
- 功能点2: [描述]
- ...

## 用户体验 (User Experience)
[描述用户如何与功能交互]
- 用户群体: [描述]
- 关键用户流程: [描述]
- UI/UX考虑: [描述]

## 技术架构 (Technical Architecture)
[概述技术实现细节]
- 系统组件: [描述]
- 数据模型: [描述]
- API和集成: [描述]
- 基础设施需求: [描述]

## 开发路线图 (Development Roadmap)
[将开发过程分解为阶段]
- MVP要求: [描述]
- 未来增强: [描述]

## 逻辑依赖链 (Logical Dependency Chain)
[定义开发的逻辑顺序]
- 需先构建的功能: [描述]
- 快速实现可用前端: [描述]
- 功能原子性与迭代考虑: [描述]

## 风险与缓解策略 (Risks and Mitigations)
[识别潜在风险并说明应对方法]
- 技术挑战: [描述]
- MVP确定: [描述]
- 资源约束: [描述]

## 附录 (Appendix)
[包含任何其他信息]
- 研究发现: [描述]
- 技术规格: [描述]
```

## 示例对话

### 初始需求表述
用户: "我需要一个功能，让用户可以把他们的数据导出成CSV文件。"

### 需求澄清对话
AI: "我注意到您正在描述一个新功能需求 - 数据导出为CSV。为了更好地理解并帮助您实现它，我需要收集一些关键信息：

1. 关于这个CSV导出功能：
   - 具体需要导出哪些数据？是用户的个人数据，还是系统中的特定数据集？
   - 这个功能主要面向哪些用户角色？
   - 实现这个功能的主要价值是什么？"

用户: "这是面向我们的企业客户，让他们可以导出他们在我们平台上的营销活动数据，包括活动表现、受众反馈等。主要是为了让他们能进行离线分析和报告。"

AI: "了解了，这是面向企业客户的营销数据导出功能。我再了解一些细节：

2. 关于功能范围：
   - 需要导出哪些具体字段？例如活动名称、日期、点击率、转化率等
   - 用户应该能选择导出特定时间范围的数据吗？
   - 有对文件大小或数据量的限制考虑吗？"

[对话继续，收集所有必要信息...]

### PRD生成与确认
AI: "根据我们的讨论，我已经整理出一份PRD草案，请您审阅：

```markdown
# 营销数据CSV导出功能 PRD

## 概述
为企业客户提供将营销活动数据导出为CSV格式的功能，使他们能够进行离线数据分析和创建自定义报告。解决了客户需要在外部工具中处理平台数据的需求。

## 核心功能
- 数据选择: 允许用户选择要导出的特定营销活动和数据类型
- 时间筛选: 支持按日期范围过滤数据
- 格式化选项: 提供基本的CSV格式选项(分隔符、包含表头等)
- 下载管理: 生成文件并提供安全下载链接

...
```

请您查看这份PRD是否符合您的期望，是否有需要修改或补充的地方？确认后，我们可以基于此创建相应的开发任务。"

## 最佳实践

1. **主动引导但不过度引导**
   - 提供结构化问题，但允许用户灵活回答
   - 不预设具体解决方案或实现细节

2. **渐进式细化**
   - 从高层次问题开始，逐步深入技术细节
   - 在用户分享信息后再提出更具体的问题

3. **及时反馈与总结**
   - 定期总结已收集的信息
   - 在进入新的问题领域前确认之前的理解是否准确

4. **区分必要与可选信息**
   - 明确标识哪些是必需的核心信息
   - 对缺失的必要信息提出跟进问题

5. **适应不同类型的需求**
   - 为功能型、非功能型、UI/UX需求调整问题结构
   - 为不同规模的项目(小功能vs大型系统)灵活调整PRD模板
